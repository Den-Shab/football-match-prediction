# Football-match-prediction
## Идея:
Использовать машинное обучение для предсказания результата матча (победа, поражение, ничья) на основе данных о командах, игроках и других факторов (например, погода, травмы).
![image](https://github.com/user-attachments/assets/7193a18a-93c0-4cde-9c17-9dce7a554108)

## План: 
1) Собрать данные из датасетов и других открытых источников (ссылка на данные - https://www.kaggle.com/datasets/panaaaaa/english-premier-league-and-championship-full-dataset)
2) Выбрать модель
3) Оценить модель на реальных событиях, которые произойдут в ближайшем будущем

## Основные возможности:
- Прогнозирование результатов матчей (победа хозяев/ничья/победа гостей)
- Визуализация турнирной таблицы
- Анализ важности признаков

## Установка:
1) Клонировать репозиторий
   - git clone https://github.com/Den-Shab/football-match-prediction.git
   - cd football-match-prediction
2) Установить зависимости
   - pip install -r requirements.txt
3) Скачать данные по ссылке https://www.kaggle.com/datasets/panaaaaa/english-premier-league-and-championship-full-dataset
и разместить в директории /path/to/repo/data
3) Установить глобальную переменную в корень репозитория
   - export PYTHONPATH=${PYTHONPATH}:/path/to/repo
5) Выполнить препроцессинг
   - python src/data_preprocessing.py
6) Обучить модель(можно использовать уже обученную, тогда пропуск шага)
   - python src/train.py
   - дополнение: обучить модель можно с подбором оптимальных гиперпараметров
        - python src/train.py tune_hyperparams
7) Запустить графический интерфейс и использовать приложение
   - python predictor_app.py

## Результаты
В целом, получилось достаточно интересное решение, которое показало неплохие результаты.

![image](https://github.com/user-attachments/assets/f4db80a8-ca35-4d2f-882b-94873d3777b0)

Важно отметить тот факт, что модель могла быть обучена только на тех показателях, которые могут быть теоретически известны на момент начала матча (например, нельзя использовать наличие красных карточек, так как для предсказания будущего матча невозможно определить, будет получена красная карточка или нет). Этим объясняется важность feature_engineering, в ходе которого были получены некоторые важные статистические показатели. 

Именно поэтому угадывать результаты в почти двух из трех случаев - достаточно качественный показатель, если учитывать количество факторов, в действительности влияющее на результат и не поддающееся замерам (как, например, психология игроков и судей, состояние газона)

Это же подтверждают результаты других пользователей Kaggle для данного датасета, значение accuracy у которых, в среднем, было равно 60% (при том, что на них не были наложены ограничения по работе с данными, https://www.kaggle.com/code/ishraqalibon/english-premier-league-prediction). Если же обратиться к другим датасетам с данной тематикой, то там, зачастую, модели не могут пробить даже 50%. Еще одним фактом, подтвержадющим относительно высокое качество решения, является факт существования букмекерских контор. Ведь если бы люди смогли обучить модель, дающую более 80%-85% точных прогнозов, то все БК бы обанкротились...

Кстати, про БК
В качестве эксперимента(его легко повторить, тестовые данные занесены в файл predict.py, его можно вызвать напрямую), были предсказаны результаты матчей в туре, следующем после последнего, представленного в датасете.

![image](https://github.com/user-attachments/assets/2ee9d3e5-8abd-4864-86ae-f657383f0078) 

На данном скриншоте - реальные результаты того тура, а также коэффиценты одной из БК на исходы каждого из матчей
А вот что предсказала модель:

![Screenshot from 2025-03-07 00-15-25](https://github.com/user-attachments/assets/01bcc19a-99cf-4d6c-ae15-c8e55f71982b)

Простая математика: предположим, что на старте мы имеем бюджет 1000 у.е. и делаем ставки на все события согласно предсказаниям нашей модели, по 100 у.е. на каждое событие. В случае победы, мы получаем 100 * коэффицент, в случае поражения - теряем 100 у.е.
Результаты:

    +144 у.е.
    +138 у.е.
    +  0 у.е.
    +139 у.е.
    +  0 у.е.
    +  0 у.е.
    +148 у.е.
    +  0 у.е.
    +180 у.е.
    +490 у.е.

Итог: 1239 у.е.

Мы получили профит 24%

Это демонстрирует и практическую значимость модели, и метод, как данный инструмент может приносить прибыль (помимо этого, прогнозы можно продавать и также зарабатывать на этом)

Также стоит отметить тот факт, что модель в двнном случае действительно дает "продуманные" предсказания и иногда даже делает выбор в пользу аутсайдеров (как, например, в случае с Борнмутом), а не всегда в лоб "ставит" на фаворитов.
Еще один пример, демонстрирующий данную хорошую черту модели, а также показывающий небольшое демо-приложение:

![Screenshot from 2025-03-07 00-55-31](https://github.com/user-attachments/assets/4af6d385-2bb3-4dc7-a0ce-cdb7166d14b8)

В то же время, проект имеет достаточно большой потенциал для развития. В частности, можно попробовать перейти к более сложным архитектурам, в частности, из области глубинного обучения, добавить данные (об игроках, погодных условиях), придумать более комплексные признаки (например, перейти в пространство эмбеддингов). Вполне возможно, что данные изменения повлияют на качество предсказаний в лучшую сторону


